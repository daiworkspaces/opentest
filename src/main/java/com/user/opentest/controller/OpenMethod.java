package com.user.opentest.controller;


import com.user.opentest.model.UserTestCase;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import lombok.extern.log4j.Log4j2;
import org.mybatis.spring.SqlSessionTemplate;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

@Log4j2
@RestController
@Api(value = "/")
@RequestMapping("v1")

public class OpenMethod {

    @Autowired

    private SqlSessionTemplate template ;
    //produces = "text/html;charset=UTF-8" 解决中文乱码

    @RequestMapping(value = "/getCaseOne/{id}",method = RequestMethod.GET,produces = "text/html;charset=UTF-8")
    @ApiOperation(value = "通过id查询单条测试用例数据",httpMethod = "GET")
    public String getCaseListOne(@PathVariable Integer id){
        String result;
        result = template.selectOne("getCaseOne",id).toString();
        return result;

//        List<UserTestCase> userTestCases = template.selectList("getCaseListOne",id);
//        System.out.println(userTestCases+"======================");
//        return userTestCases;

    }

    //SQL分页查询
    //currIndex 当前页
    //pagesize 每页大小
    @RequestMapping(value = "/getCaseListInfo/{currPage}/{pageSize}",method = RequestMethod.GET,produces = "text/html;charset=UTF-8")
    @ApiOperation(value = "分页查询测试用例列表数据",httpMethod = "GET")
    public String getCaseListInfo(@PathVariable Integer currPage,
                                              @PathVariable Integer pageSize){

        Map<String,Integer> data = new HashMap<>();
        data.put("currIndex",(currPage-1)*pageSize);
        data.put("pageSize",pageSize);

        List<UserTestCase> userTestCases =template.selectList("getCaseListInfo",data);
        return userTestCases.toString();



    }







}
